<div [ngClass]="(isMobile | async) ? 'container-mobile' : 'container-desktop'" class="osm-container">
  <nz-select
    [ngStyle]="{ 'width': '100%'}"
    [compareWith]="compareByIdFn"
    (ngModelChange)="onSeasonSelected($event)"
    [ngModel]="selectedSeason"
  >
    @for(season of state.seasons(); track season.id) {
    <nz-option [nzValue]="season" [nzLabel]="season.name"></nz-option>
    }
  </nz-select>

  @for (month of fixtures().keys(); track month) {
  <nz-divider [nzText]="month" nzOrientation="left" class="g-divider-large"></nz-divider>
  <ul>
    @for (fixture of fixtures().get(month); track fixture.id) {
    <li>
      <!--      [routerLink]="['/results', fixture.id]"-->
      <nz-card>
        <!------------>
        <!------------>
        <!-- Mobile -->
        <!------------>
        <!------------>
        @if(isMobile | async) {
        <div class="card-mobile">
          <section>
            <div class="date-division">
              <ng-container *ngTemplateOutlet="date"></ng-container>
              <ng-container *ngTemplateOutlet="competition"></ng-container>
            </div>
            <ng-container *ngTemplateOutlet="venue"></ng-container>
          </section>

          <section class="team-names">
            <img [ngSrc]="icon()" width="64" height="64" alt="fixture-icon" />
            <img [ngSrc]="icon()" class="icon-transform" width="64" height="64" alt="fixture-icon" />
            <section>
              <ng-container *ngTemplateOutlet="homeTeam"></ng-container>
              <ng-container *ngTemplateOutlet="opponentTeam"></ng-container>
            </section>
          </section>

          <section class="time-score">
            <ng-container *ngTemplateOutlet="timeOrScore"></ng-container>
          </section>
        </div>
        } @else {
        <!------------->
        <!------------->
        <!-- Desktop -->
        <!------------->
        <!------------->
        <div class="card-desktop">
          <div>
            <img [ngSrc]="icon()" class="icon-rotate" width="64" height="64" alt="fixture-icon" />
            <img [ngSrc]="icon()" class="icon-transform" width="64" height="64" alt="fixture-icon" />
            <section>
              <div class="date-division">
                <ng-container *ngTemplateOutlet="date"></ng-container>
                <ng-container *ngTemplateOutlet="competition"></ng-container>
              </div>
              <ng-container *ngTemplateOutlet="homeTeam"></ng-container>
              <ng-container *ngTemplateOutlet="opponentTeam"></ng-container>
              <ng-container *ngTemplateOutlet="venue"></ng-container>
            </section>
          </div>
          <ng-container *ngTemplateOutlet="timeOrScore"></ng-container>
        </div>
        }
      </nz-card>
    </li>

    <ng-template #date>
      <p class="g-uppercase">{{ fixture.date | date:'MMM d, y' }}</p>
    </ng-template>

    <ng-template #competition>
      <span class="g-uppercase competition"> {{ fixture.competition?.tier }} </span>
    </ng-template>

    <ng-template #homeTeam>
      <p class="team-names">Old Speckled Men</p>
    </ng-template>

    <ng-template #opponentTeam>
      <p class="team-names">{{ fixture.opponent?.name }}</p>
    </ng-template>

    <ng-template #venue>
      <p class="g-uppercase">{{ fixture.venue?.name || 'TBC' }}</p>
    </ng-template>

    <ng-template #timeOrScore>
      @if (showFixtures()) {
      <nz-tag [nzColor]="'#7bbeed'" class="time-display">
        <p>{{ !fixture.time ? 'TBC' : fixture.time | date: 'HH:mm' }}</p>
      </nz-tag>
      } @else {
      <nz-tag [nzColor]="getScoreColor(fixture.homeGoals, fixture.opponentGoals, fixture.penaltiesHome, fixture.penaltiesOpponent)" class="time-display">
        @if(fixture.penalties) {
        <p>
          {{ fixture.homeGoals }} ({{ fixture.penaltiesHome }}) - {{ fixture.opponentGoals }} ({{
          fixture.penaltiesOpponent }})
        </p>
        } @else {
        <p>{{ fixture.homeGoals }} - {{ fixture.opponentGoals }}</p>
        }
      </nz-tag>
      }
    </ng-template>
    }
  </ul>
  } @if (!this.fixtures().size) {
  <div style="text-align: center; margin-top: 100px">
    <h1>{{ 'Season Break' | uppercase }}</h1>
    <p>View our performance from the 2024/25 season <a routerLink="/stats">here</a></p>
  </div>
  }
</div>
